{"pageProps":{"post":{"title":"逆元を求める","date":"2021-08-16T18:35:07","slug":"逆元を求める","content":"<h2>逆元を求める</h2>\n<p>法$p$の元での逆元を求めたい。</p>\n<p>すなわち、</p>\n<p>$$\na^{-1} \\cdot a \\equiv  1 \\pmod p\n$$</p>\n<p>を満たす $a^{-1}$ を求める。</p>\n<p>このとき、$a$ と $p$ は互いに素とする。</p>\n<h3>式変形</h3>\n<p>$p$を$a$で割ると</p>\n<p>$$\np = \\lfloor \\frac{p}{a} \\rfloor \\cdot a + (p \\mod a)\n$$</p>\n<p>より、</p>\n<p>$$\n0 \\equiv \\lfloor \\frac{p}{a} \\rfloor \\cdot a + (p \\mod a) \\pmod p\n$$</p>\n<p>$$\n(p \\mod a) \\cdot a^{-1} \\equiv - \\lfloor \\frac{p}{a} \\rfloor \\pmod p\n$$</p>\n<p>$$\na^{-1} \\equiv -(p \\mod a)^{-1} \\cdot \\lfloor \\frac{p}{a} \\rfloor \\pmod p\n$$</p>\n<p>よって、$p \\mod a$ の逆元が求められていたら $a^{-1}$も簡潔に求められる。</p>\n<p>$p = 7$ として実験してみると、</p>\n<p>$$\n1^{-1} \\equiv 1 \\pmod 7\n$$\n$$\n2^{-1} \\equiv - (7 \\mod 2)^{-1} \\cdot \\lfloor \\frac{7}{2} \\rfloor \\equiv -1 \\cdot 3 \\equiv 4 \\pmod 7\n$$</p>\n<p>$$\n3^{-1} \\equiv - (7 \\mod 3)^{-1} \\cdot \\lfloor\n\\frac{7}{3} \\rfloor \\equiv -1 \\cdot 2 \\equiv 5\n$$</p>\n<p>$$\n4^{-1} \\equiv -(7 \\mod 4)^{-1} \\cdot \\lfloor \\frac{7}{4} \\rfloor \\equiv - 3^{-1} \\cdot 1 \\equiv -5 \\equiv 2\n$$</p>\n<p>のように$1^{-1}$を起点として逆元を求めていくことができる。</p>\n<h3>拡張ユークリッドの互除法</h3>\n<p>逆元を求めるには、</p>\n<p>$$\na^{-1} \\cdot a \\equiv 1 \\pmod p\n$$</p>\n<p>$$\na^{-1} \\cdot a - 1 \\equiv 0 \\pmod p\n$$\nより、</p>\n<p>不定方程式\n$$\na^{-1} \\cdot a - 1 = n \\cdot p\n$$\nとなる。</p>\n<p>少し変形して、</p>\n<p>$$\na^{-1} \\cdot a + n\\cdot p = 1\n$$</p>\n<p>が得られ、拡張ユークリッドの互除法で求められそうな式ができる。</p>\n<p>$$\nax + py = 1\n$$\nの解を求めたときの$x$ が $a^{-1}$ である。</p>\n<p>$p$を$a$で割ると、</p>\n<p>$$\np = qa + r\n$$</p>\n<p>になるとする。</p>\n<p>これをもとの式に代入して、</p>\n<p>$$\nax + (qa + r)y = 1 \\Leftrightarrow ry + a(x+qy) = 1\n$$</p>\n<p>よって、\n$a,p$ に関する問題が $\\lfloor p/a \\rfloor$, $p \\mod a$ の問題に帰着できる。</p>\n<p>この操作を続けていき、自明解に行き着く。\n$$\nrs + at = 1\n$$</p>\n<p>と解が得られたら、</p>\n<p>$$\n\\left{\n\\begin{aligned}\ns &#x26;= y\\ t &#x26;= x+qy\n\\end{aligned}\n\\right.\n\\Leftrightarrow \\left{\n\\begin{aligned}\nx &#x26;= t-qs\\ y &#x26;= s\n\\end{aligned}\n\\right.\n$$</p>\n<p>で$x,y$ を戻していくことができる。</p>\n<p>よって$x$が求められる。</p>\n<h2>フェルマーの小定理</h2>\n<p>$p$ が素数で $a$ と $p$ が互いに素なとき、以下の式が成立する。</p>\n<p>$$\na^{p-1} \\equiv 1 \\pmod p\n$$</p>\n<p>このとき、\n$$\na^{p-2}\\cdot a \\equiv 1 \\pmod p\n$$</p>\n<p>であるから、</p>\n<p>$$\na^{-1} \\equiv a^{p-2}  \\pmod p\n$$\nが成立する。</p>\n<p>※ この計算は繰り返し二乗法を用いることで$\\lceil\\log_2 p\\rceil$回程度の乗算で計算できる。</p>\n","tags":["基礎","整数論"]}},"__N_SSG":true}