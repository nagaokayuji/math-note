{"pageProps":{"post":{"title":"逆元を求める","date":"2021-08-16T18:35:07","slug":"逆元を求める","content":"<h2>逆元を求める</h2>\n<p>法<span><span><span>pp</span><span aria-hidden=\"true\"><span><span></span><span>p</span></span></span></span></span>の元での逆元を求めたい。</p>\n<p>すなわち、</p>\n<div><span><span><span>a−1⋅a≡1(modp)a^{-1} \\cdot a \\equiv  1 \\pmod p</span><span aria-hidden=\"true\"><span><span></span><span><span>a</span><span><span><span><span><span><span></span><span><span><span>−</span><span>1</span></span></span></span></span></span></span></span></span><span></span><span>⋅</span><span></span></span><span><span></span><span>a</span><span></span><span>≡</span><span></span></span><span><span></span><span>1</span><span></span><span></span></span><span><span></span><span>(</span><span><span><span>m</span><span>o</span><span>d</span></span></span><span></span><span>p</span><span>)</span></span></span></span></span></div>\n<p>を満たす <span><span><span>a−1a^{-1}</span><span aria-hidden=\"true\"><span><span></span><span><span>a</span><span><span><span><span><span><span></span><span><span><span>−</span><span>1</span></span></span></span></span></span></span></span></span></span></span></span></span> を求める。</p>\n<p>このとき、<span><span><span>aa</span><span aria-hidden=\"true\"><span><span></span><span>a</span></span></span></span></span> と <span><span><span>pp</span><span aria-hidden=\"true\"><span><span></span><span>p</span></span></span></span></span> は互いに素とする。</p>\n<h3>式変形</h3>\n<p><span><span><span>pp</span><span aria-hidden=\"true\"><span><span></span><span>p</span></span></span></span></span>を<span><span><span>aa</span><span aria-hidden=\"true\"><span><span></span><span>a</span></span></span></span></span>で割ると</p>\n<div><span><span><span>p=⌊pa⌋⋅a+(pmod  a)p = \\lfloor \\frac{p}{a} \\rfloor \\cdot a + (p \\mod a)</span><span aria-hidden=\"true\"><span><span></span><span>p</span><span></span><span>=</span><span></span></span><span><span></span><span>⌊</span><span><span></span><span><span><span><span><span><span></span><span><span>a</span></span></span><span><span></span><span></span></span><span><span></span><span><span>p</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span>⌋</span><span></span><span>⋅</span><span></span></span><span><span></span><span>a</span><span></span><span>+</span><span></span></span><span><span></span><span>(</span><span>p</span><span></span><span></span></span><span><span></span><span><span><span>m</span><span>o</span><span>d</span></span></span><span></span><span></span><span>a</span><span>)</span></span></span></span></span></div>\n<p>より、</p>\n<div><span><span><span>0≡⌊pa⌋⋅a+(pmod  a)(modp)0 \\equiv \\lfloor \\frac{p}{a} \\rfloor \\cdot a + (p \\mod a) \\pmod p</span><span aria-hidden=\"true\"><span><span></span><span>0</span><span></span><span>≡</span><span></span></span><span><span></span><span>⌊</span><span><span></span><span><span><span><span><span><span></span><span><span>a</span></span></span><span><span></span><span></span></span><span><span></span><span><span>p</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span>⌋</span><span></span><span>⋅</span><span></span></span><span><span></span><span>a</span><span></span><span>+</span><span></span></span><span><span></span><span>(</span><span>p</span><span></span><span></span></span><span><span></span><span><span><span>m</span><span>o</span><span>d</span></span></span><span></span><span></span><span>a</span><span>)</span><span></span><span></span></span><span><span></span><span>(</span><span><span><span>m</span><span>o</span><span>d</span></span></span><span></span><span>p</span><span>)</span></span></span></span></span></div>\n<div><span><span><span>(pmod  a)⋅a−1≡−⌊pa⌋(modp)(p \\mod a) \\cdot a^{-1} \\equiv - \\lfloor \\frac{p}{a} \\rfloor \\pmod p</span><span aria-hidden=\"true\"><span><span></span><span>(</span><span>p</span><span></span><span></span></span><span><span></span><span><span><span>m</span><span>o</span><span>d</span></span></span><span></span><span></span><span>a</span><span>)</span><span></span><span>⋅</span><span></span></span><span><span></span><span><span>a</span><span><span><span><span><span><span></span><span><span><span>−</span><span>1</span></span></span></span></span></span></span></span></span><span></span><span>≡</span><span></span></span><span><span></span><span>−</span><span>⌊</span><span><span></span><span><span><span><span><span><span></span><span><span>a</span></span></span><span><span></span><span></span></span><span><span></span><span><span>p</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span>⌋</span><span></span><span></span></span><span><span></span><span>(</span><span><span><span>m</span><span>o</span><span>d</span></span></span><span></span><span>p</span><span>)</span></span></span></span></span></div>\n<div><span><span><span>a−1≡−(pmod  a)−1⋅⌊pa⌋(modp)a^{-1} \\equiv -(p \\mod a)^{-1} \\cdot \\lfloor \\frac{p}{a} \\rfloor \\pmod p</span><span aria-hidden=\"true\"><span><span></span><span><span>a</span><span><span><span><span><span><span></span><span><span><span>−</span><span>1</span></span></span></span></span></span></span></span></span><span></span><span>≡</span><span></span></span><span><span></span><span>−</span><span>(</span><span>p</span><span></span><span></span></span><span><span></span><span><span><span>m</span><span>o</span><span>d</span></span></span><span></span><span></span><span>a</span><span><span>)</span><span><span><span><span><span><span></span><span><span><span>−</span><span>1</span></span></span></span></span></span></span></span></span><span></span><span>⋅</span><span></span></span><span><span></span><span>⌊</span><span><span></span><span><span><span><span><span><span></span><span><span>a</span></span></span><span><span></span><span></span></span><span><span></span><span><span>p</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span>⌋</span><span></span><span></span></span><span><span></span><span>(</span><span><span><span>m</span><span>o</span><span>d</span></span></span><span></span><span>p</span><span>)</span></span></span></span></span></div>\n<p>よって、<span><span><span>pmod  ap \\mod a</span><span aria-hidden=\"true\"><span><span></span><span>p</span><span></span><span></span></span><span><span></span><span><span><span>m</span><span>o</span><span>d</span></span></span><span></span><span></span><span>a</span></span></span></span></span> の逆元が求められていたら <span><span><span>a−1a^{-1}</span><span aria-hidden=\"true\"><span><span></span><span><span>a</span><span><span><span><span><span><span></span><span><span><span>−</span><span>1</span></span></span></span></span></span></span></span></span></span></span></span></span>も簡潔に求められる。</p>\n<p><span><span><span>p=7p = 7</span><span aria-hidden=\"true\"><span><span></span><span>p</span><span></span><span>=</span><span></span></span><span><span></span><span>7</span></span></span></span></span> として実験してみると、</p>\n<div><span><span><span>1−1≡1(mod7)1^{-1} \\equiv 1 \\pmod 7</span><span aria-hidden=\"true\"><span><span></span><span><span>1</span><span><span><span><span><span><span></span><span><span><span>−</span><span>1</span></span></span></span></span></span></span></span></span><span></span><span>≡</span><span></span></span><span><span></span><span>1</span><span></span><span></span></span><span><span></span><span>(</span><span><span><span>m</span><span>o</span><span>d</span></span></span><span></span><span>7</span><span>)</span></span></span></span></span></div>\n<div><span><span><span>2−1≡−(7mod  2)−1⋅⌊72⌋≡−1⋅3≡4(mod7)2^{-1} \\equiv - (7 \\mod 2)^{-1} \\cdot \\lfloor \\frac{7}{2} \\rfloor \\equiv -1 \\cdot 3 \\equiv 4 \\pmod 7</span><span aria-hidden=\"true\"><span><span></span><span><span>2</span><span><span><span><span><span><span></span><span><span><span>−</span><span>1</span></span></span></span></span></span></span></span></span><span></span><span>≡</span><span></span></span><span><span></span><span>−</span><span>(</span><span>7</span><span></span><span></span></span><span><span></span><span><span><span>m</span><span>o</span><span>d</span></span></span><span></span><span></span><span>2</span><span><span>)</span><span><span><span><span><span><span></span><span><span><span>−</span><span>1</span></span></span></span></span></span></span></span></span><span></span><span>⋅</span><span></span></span><span><span></span><span>⌊</span><span><span></span><span><span><span><span><span><span></span><span><span>2</span></span></span><span><span></span><span></span></span><span><span></span><span><span>7</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span>⌋</span><span></span><span>≡</span><span></span></span><span><span></span><span>−</span><span>1</span><span></span><span>⋅</span><span></span></span><span><span></span><span>3</span><span></span><span>≡</span><span></span></span><span><span></span><span>4</span><span></span><span></span></span><span><span></span><span>(</span><span><span><span>m</span><span>o</span><span>d</span></span></span><span></span><span>7</span><span>)</span></span></span></span></span></div>\n<div><span><span><span>3−1≡−(7mod  3)−1⋅⌊73⌋≡−1⋅2≡53^{-1} \\equiv - (7 \\mod 3)^{-1} \\cdot \\lfloor \n\\frac{7}{3} \\rfloor \\equiv -1 \\cdot 2 \\equiv 5</span><span aria-hidden=\"true\"><span><span></span><span><span>3</span><span><span><span><span><span><span></span><span><span><span>−</span><span>1</span></span></span></span></span></span></span></span></span><span></span><span>≡</span><span></span></span><span><span></span><span>−</span><span>(</span><span>7</span><span></span><span></span></span><span><span></span><span><span><span>m</span><span>o</span><span>d</span></span></span><span></span><span></span><span>3</span><span><span>)</span><span><span><span><span><span><span></span><span><span><span>−</span><span>1</span></span></span></span></span></span></span></span></span><span></span><span>⋅</span><span></span></span><span><span></span><span>⌊</span><span><span></span><span><span><span><span><span><span></span><span><span>3</span></span></span><span><span></span><span></span></span><span><span></span><span><span>7</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span>⌋</span><span></span><span>≡</span><span></span></span><span><span></span><span>−</span><span>1</span><span></span><span>⋅</span><span></span></span><span><span></span><span>2</span><span></span><span>≡</span><span></span></span><span><span></span><span>5</span></span></span></span></span></div>\n<div><span><span><span>4−1≡−(7mod  4)−1⋅⌊74⌋≡−3−1⋅1≡−5≡24^{-1} \\equiv -(7 \\mod 4)^{-1} \\cdot \\lfloor \\frac{7}{4} \\rfloor \\equiv - 3^{-1} \\cdot 1 \\equiv -5 \\equiv 2</span><span aria-hidden=\"true\"><span><span></span><span><span>4</span><span><span><span><span><span><span></span><span><span><span>−</span><span>1</span></span></span></span></span></span></span></span></span><span></span><span>≡</span><span></span></span><span><span></span><span>−</span><span>(</span><span>7</span><span></span><span></span></span><span><span></span><span><span><span>m</span><span>o</span><span>d</span></span></span><span></span><span></span><span>4</span><span><span>)</span><span><span><span><span><span><span></span><span><span><span>−</span><span>1</span></span></span></span></span></span></span></span></span><span></span><span>⋅</span><span></span></span><span><span></span><span>⌊</span><span><span></span><span><span><span><span><span><span></span><span><span>4</span></span></span><span><span></span><span></span></span><span><span></span><span><span>7</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span></span></span><span>⌋</span><span></span><span>≡</span><span></span></span><span><span></span><span>−</span><span><span>3</span><span><span><span><span><span><span></span><span><span><span>−</span><span>1</span></span></span></span></span></span></span></span></span><span></span><span>⋅</span><span></span></span><span><span></span><span>1</span><span></span><span>≡</span><span></span></span><span><span></span><span>−</span><span>5</span><span></span><span>≡</span><span></span></span><span><span></span><span>2</span></span></span></span></span></div>\n<p>のように<span><span><span>1−11^{-1}</span><span aria-hidden=\"true\"><span><span></span><span><span>1</span><span><span><span><span><span><span></span><span><span><span>−</span><span>1</span></span></span></span></span></span></span></span></span></span></span></span></span>を起点として逆元を求めていくことができる。</p>\n<h3>拡張ユークリッドの互除法</h3>\n<p>逆元を求めるには、</p>\n<div><span><span><span>a−1⋅a≡1(modp)a^{-1} \\cdot a \\equiv 1 \\pmod p</span><span aria-hidden=\"true\"><span><span></span><span><span>a</span><span><span><span><span><span><span></span><span><span><span>−</span><span>1</span></span></span></span></span></span></span></span></span><span></span><span>⋅</span><span></span></span><span><span></span><span>a</span><span></span><span>≡</span><span></span></span><span><span></span><span>1</span><span></span><span></span></span><span><span></span><span>(</span><span><span><span>m</span><span>o</span><span>d</span></span></span><span></span><span>p</span><span>)</span></span></span></span></span></div>\n<div><span><span><span>a−1⋅a−1≡0(modp)a^{-1} \\cdot a - 1 \\equiv 0 \\pmod p</span><span aria-hidden=\"true\"><span><span></span><span><span>a</span><span><span><span><span><span><span></span><span><span><span>−</span><span>1</span></span></span></span></span></span></span></span></span><span></span><span>⋅</span><span></span></span><span><span></span><span>a</span><span></span><span>−</span><span></span></span><span><span></span><span>1</span><span></span><span>≡</span><span></span></span><span><span></span><span>0</span><span></span><span></span></span><span><span></span><span>(</span><span><span><span>m</span><span>o</span><span>d</span></span></span><span></span><span>p</span><span>)</span></span></span></span></span></div>\n<p>より、</p>\n<p>不定方程式</p>\n<div><span><span><span>a−1⋅a−1=n⋅pa^{-1} \\cdot a - 1 = n \\cdot p</span><span aria-hidden=\"true\"><span><span></span><span><span>a</span><span><span><span><span><span><span></span><span><span><span>−</span><span>1</span></span></span></span></span></span></span></span></span><span></span><span>⋅</span><span></span></span><span><span></span><span>a</span><span></span><span>−</span><span></span></span><span><span></span><span>1</span><span></span><span>=</span><span></span></span><span><span></span><span>n</span><span></span><span>⋅</span><span></span></span><span><span></span><span>p</span></span></span></span></span></div>\n<p>となる。</p>\n<p>少し変形して、</p>\n<div><span><span><span>a−1⋅a+n⋅p=1a^{-1} \\cdot a + n\\cdot p = 1</span><span aria-hidden=\"true\"><span><span></span><span><span>a</span><span><span><span><span><span><span></span><span><span><span>−</span><span>1</span></span></span></span></span></span></span></span></span><span></span><span>⋅</span><span></span></span><span><span></span><span>a</span><span></span><span>+</span><span></span></span><span><span></span><span>n</span><span></span><span>⋅</span><span></span></span><span><span></span><span>p</span><span></span><span>=</span><span></span></span><span><span></span><span>1</span></span></span></span></span></div>\n<p>が得られ、拡張ユークリッドの互除法で求められそうな式ができる。</p>\n<div><span><span><span>ax+py=1ax + py = 1</span><span aria-hidden=\"true\"><span><span></span><span>a</span><span>x</span><span></span><span>+</span><span></span></span><span><span></span><span>p</span><span>y</span><span></span><span>=</span><span></span></span><span><span></span><span>1</span></span></span></span></span></div>\n<p>の解を求めたときの<span><span><span>xx</span><span aria-hidden=\"true\"><span><span></span><span>x</span></span></span></span></span> が <span><span><span>a−1a^{-1}</span><span aria-hidden=\"true\"><span><span></span><span><span>a</span><span><span><span><span><span><span></span><span><span><span>−</span><span>1</span></span></span></span></span></span></span></span></span></span></span></span></span> である。</p>\n<p><span><span><span>pp</span><span aria-hidden=\"true\"><span><span></span><span>p</span></span></span></span></span>を<span><span><span>aa</span><span aria-hidden=\"true\"><span><span></span><span>a</span></span></span></span></span>で割ると、</p>\n<div><span><span><span>p=qa+rp = qa + r</span><span aria-hidden=\"true\"><span><span></span><span>p</span><span></span><span>=</span><span></span></span><span><span></span><span>q</span><span>a</span><span></span><span>+</span><span></span></span><span><span></span><span>r</span></span></span></span></span></div>\n<p>になるとする。</p>\n<p>これをもとの式に代入して、</p>\n<div><span><span><span>ax+(qa+r)y=1⇔ry+a(x+qy)=1ax + (qa + r)y = 1 \\Leftrightarrow ry + a(x+qy) = 1</span><span aria-hidden=\"true\"><span><span></span><span>a</span><span>x</span><span></span><span>+</span><span></span></span><span><span></span><span>(</span><span>q</span><span>a</span><span></span><span>+</span><span></span></span><span><span></span><span>r</span><span>)</span><span>y</span><span></span><span>=</span><span></span></span><span><span></span><span>1</span><span></span><span>⇔</span><span></span></span><span><span></span><span>r</span><span>y</span><span></span><span>+</span><span></span></span><span><span></span><span>a</span><span>(</span><span>x</span><span></span><span>+</span><span></span></span><span><span></span><span>q</span><span>y</span><span>)</span><span></span><span>=</span><span></span></span><span><span></span><span>1</span></span></span></span></span></div>\n<p>よって、\n<span><span><span>a,pa,p</span><span aria-hidden=\"true\"><span><span></span><span>a</span><span>,</span><span></span><span>p</span></span></span></span></span> に関する問題が <span><span><span>⌊p/a⌋\\lfloor p/a \\rfloor</span><span aria-hidden=\"true\"><span><span></span><span>⌊</span><span>p</span><span>/</span><span>a</span><span>⌋</span></span></span></span></span>, <span><span><span>pmod  ap \\mod a</span><span aria-hidden=\"true\"><span><span></span><span>p</span><span></span><span></span></span><span><span></span><span><span><span>m</span><span>o</span><span>d</span></span></span><span></span><span></span><span>a</span></span></span></span></span> の問題に帰着できる。</p>\n<p>この操作を続けていき、自明解に行き着く。</p>\n<div><span><span><span>rs+at=1rs + at = 1</span><span aria-hidden=\"true\"><span><span></span><span>r</span><span>s</span><span></span><span>+</span><span></span></span><span><span></span><span>a</span><span>t</span><span></span><span>=</span><span></span></span><span><span></span><span>1</span></span></span></span></span></div>\n<p>と解が得られたら、</p>\n<div><span><span><span>{s=yt=x+qy⇔{x=t−qsy=s\\left\\{\n\\begin{aligned}\ns &#x26;= y\\\\ t &#x26;= x+qy\n\\end{aligned}\n\\right.\n\\Leftrightarrow \\left\\{\n\\begin{aligned}\nx &#x26;= t-qs\\\\ y &#x26;= s\n\\end{aligned}\n\\right.</span><span aria-hidden=\"true\"><span><span></span><span><span><span>{</span></span><span><span><span><span><span><span><span><span></span><span><span>s</span></span></span><span><span></span><span><span>t</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span><span><span><span><span><span></span><span><span></span><span></span><span>=</span><span></span><span>y</span></span></span><span><span></span><span><span></span><span></span><span>=</span><span></span><span>x</span><span></span><span>+</span><span></span><span>q</span><span>y</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span><span></span></span><span></span><span>⇔</span><span></span></span><span><span></span><span><span><span>{</span></span><span><span><span><span><span><span><span><span></span><span><span>x</span></span></span><span><span></span><span><span>y</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span><span><span><span><span><span><span></span><span><span></span><span></span><span>=</span><span></span><span>t</span><span></span><span>−</span><span></span><span>q</span><span>s</span></span></span><span><span></span><span><span></span><span></span><span>=</span><span></span><span>s</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span></span><span></span></span></span></span></span></span></div>\n<p>で<span><span><span>x,yx,y</span><span aria-hidden=\"true\"><span><span></span><span>x</span><span>,</span><span></span><span>y</span></span></span></span></span> を戻していくことができる。</p>\n<p>よって<span><span><span>xx</span><span aria-hidden=\"true\"><span><span></span><span>x</span></span></span></span></span>が求められる。</p>\n<h2>フェルマーの小定理</h2>\n<p><span><span><span>pp</span><span aria-hidden=\"true\"><span><span></span><span>p</span></span></span></span></span> が素数で <span><span><span>aa</span><span aria-hidden=\"true\"><span><span></span><span>a</span></span></span></span></span> と <span><span><span>pp</span><span aria-hidden=\"true\"><span><span></span><span>p</span></span></span></span></span> が互いに素なとき、以下の式が成立する。</p>\n<div><span><span><span>ap−1≡1(modp)a^{p-1} \\equiv 1 \\pmod p</span><span aria-hidden=\"true\"><span><span></span><span><span>a</span><span><span><span><span><span><span></span><span><span><span>p</span><span>−</span><span>1</span></span></span></span></span></span></span></span></span><span></span><span>≡</span><span></span></span><span><span></span><span>1</span><span></span><span></span></span><span><span></span><span>(</span><span><span><span>m</span><span>o</span><span>d</span></span></span><span></span><span>p</span><span>)</span></span></span></span></span></div>\n<p>このとき、</p>\n<div><span><span><span>ap−2⋅a≡1(modp)a^{p-2}\\cdot a \\equiv 1 \\pmod p</span><span aria-hidden=\"true\"><span><span></span><span><span>a</span><span><span><span><span><span><span></span><span><span><span>p</span><span>−</span><span>2</span></span></span></span></span></span></span></span></span><span></span><span>⋅</span><span></span></span><span><span></span><span>a</span><span></span><span>≡</span><span></span></span><span><span></span><span>1</span><span></span><span></span></span><span><span></span><span>(</span><span><span><span>m</span><span>o</span><span>d</span></span></span><span></span><span>p</span><span>)</span></span></span></span></span></div>\n<p>であるから、</p>\n<div><span><span><span>a−1≡ap−2(modp)a^{-1} \\equiv a^{p-2}  \\pmod p</span><span aria-hidden=\"true\"><span><span></span><span><span>a</span><span><span><span><span><span><span></span><span><span><span>−</span><span>1</span></span></span></span></span></span></span></span></span><span></span><span>≡</span><span></span></span><span><span></span><span><span>a</span><span><span><span><span><span><span></span><span><span><span>p</span><span>−</span><span>2</span></span></span></span></span></span></span></span></span><span></span><span></span></span><span><span></span><span>(</span><span><span><span>m</span><span>o</span><span>d</span></span></span><span></span><span>p</span><span>)</span></span></span></span></span></div>\n<p>が成立する。</p>\n<p>※ この計算は繰り返し二乗法を用いることで<span><span><span>⌈log⁡2p⌉\\lceil\\log_2 p\\rceil</span><span aria-hidden=\"true\"><span><span></span><span>⌈</span><span><span>lo<span>g</span></span><span><span><span><span><span><span></span><span><span>2</span></span></span></span><span>​</span></span><span><span><span></span></span></span></span></span></span><span></span><span>p</span><span>⌉</span></span></span></span></span>回程度の乗算で計算できる。</p>\n","tags":["基礎","整数論"]}},"__N_SSG":true}