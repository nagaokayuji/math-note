<!DOCTYPE html><html lang="ja"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="icon" type="image/png" sizes="32x32" href="/math-note/favicon/favicon-32x32.png"/><link rel="shortcut icon" href="/math-note/favicon/favicon.ico"/><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-config" content="/favicon/browserconfig.xml"/><meta name="theme-color" content="#000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><meta name="description" content="mathematics"/><title>信号処理入門４</title><meta name="next-head-count" content="10"/><link rel="preload" href="/math-note/_next/static/css/7f2c1bc6a387af36.css" as="style"/><link rel="stylesheet" href="/math-note/_next/static/css/7f2c1bc6a387af36.css" data-n-g=""/><link rel="preload" href="/math-note/_next/static/css/0679eaaad63193ca.css" as="style"/><link rel="stylesheet" href="/math-note/_next/static/css/0679eaaad63193ca.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/math-note/_next/static/chunks/polyfills-a40ef1678bae11e696dba45124eadd70.js"></script><script src="/math-note/_next/static/chunks/webpack-832375101e671a83.js" defer=""></script><script src="/math-note/_next/static/chunks/framework-91d7f78b5b4003c8.js" defer=""></script><script src="/math-note/_next/static/chunks/main-a5f2beb8b3d215d7.js" defer=""></script><script src="/math-note/_next/static/chunks/pages/_app-57f97a3cc8323c9b.js" defer=""></script><script src="/math-note/_next/static/chunks/613-a72f04a2ce04000a.js" defer=""></script><script src="/math-note/_next/static/chunks/pages/posts/%5Bslug%5D-dec6356905c85262.js" defer=""></script><script src="/math-note/_next/static/j3CLuIGZanrgxVfWdCrAG/_buildManifest.js" defer=""></script><script src="/math-note/_next/static/j3CLuIGZanrgxVfWdCrAG/_ssgManifest.js" defer=""></script><script src="/math-note/_next/static/j3CLuIGZanrgxVfWdCrAG/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous"/><div class="min-h-screen"><nav class="py-4"><a href="/math-note"><a class="m-8 md:m-8 hover:underline hover:text-blue-800 cursor-pointer">Math note</a></a><a href="/math-note/tags"><a class="m-8 md:m-8 hover:underline hover:text-blue-800 cursor-pointer">Tags</a></a><a href="/math-note/about"><a class="m-8 md:m-8 hover:underline hover:text-blue-800 cursor-pointer">About</a></a></nav><main><div class="container mx-auto px-5"><h2 class="text-2xl md:text-4xl font-bold tracking-tight md:tracking-tighter leading-tight mb-20 mt-8"><a class="hover:underline" href="/math-note">Math note</a></h2><article class="mb-32"><div class="max-w-2xl mx-auto"><div class="flex flex-wrap"><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/math-note/tags/%E4%BF%A1%E5%8F%B7%E5%87%A6%E7%90%86">信号処理</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/math-note/tags/%E5%9F%BA%E7%A4%8E">基礎</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/math-note/tags/%E3%83%95%E3%83%BC%E3%83%AA%E3%82%A8%E5%A4%89%E6%8F%9B">フーリエ変換</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/math-note/tags/%E9%9B%A2%E6%95%A3%E3%83%95%E3%83%BC%E3%83%AA%E3%82%A8%E5%A4%89%E6%8F%9B">離散フーリエ変換</a></div><div class="mb-6 text-lg"><time dateTime="2021-08-14T15:35:07">2021/08/14</time></div><hr/></div><div class="max-w-2xl mx-auto"><div class="markdown-styles_markdown__1x9gM"><h2>高速フーリエ変換(Fast Fourier Transform; FFT)</h2>
<p>離散フーリエ変換を高速に計算するアルゴリズム。</p>
<p>これを応用し、多項式の乗算が高速になる。</p>
<p>応用例：</p>
<ul>
<li>OFDM</li>
</ul>
<h3>離散フーリエ変換の概要</h3>
<p>離散フーリエ変換は複素関数
$f(x)$
を複素関数
$F(t)$
に写す写像であって、次の式で定義される。
$$
F(t)= \sum_{x=0}^{N-1} f(x) \exp\left(-i\frac{2 \pi t x}{N} \right)
$$</p>
<p>逆変換にあたる離散フーリエ逆変換（Inverse Discrete Fourier Transform; IDFT）は次の式で定義される。
$$
f(x) = \frac{1}{N} \sum_{t=0}^{N-1} F(t) \exp\left(i\frac{2\pi x t}{N} \right)
$$</p>
<p>複素関数$f(x)$の離散フーリエ変換である複素関数$F(t)$は以下の式で定義される。
$$
F(t)= \sum_{x=0}^{N-1} f(x) \exp\left(-i\frac{2 \pi t x}{N} \right)
$$</p>
<p>これを愚直に計算すると $O(N^2)$ の計算量になる。</p>
<p>高速フーリエ変換は、この結果を次数$N$が$2$の累乗のときに $O(N \log N)$ の計算量で得るアルゴリズムである。</p>
<p>より一般的には、次数が $N=\prod n_i$ と素因数分解できるとき、$O(N\sum n_i)$ の計算量となる。</p>
<p>次数が $2$ の累乗の場合に最も高速に計算できる。</p>
<p>高速フーリエ変換を利用し、畳み込み積分などの計算を高速に求めることができる。
これも計算量を $O(N^2)$ から $O(N \log N)$ まで落とすことが可能となる。</p>
<p>逆変換については正変換とほぼ同じであるが、指数の符号が逆となり、係数$1/N$がかかる。</p>
<p>すなわち、</p>
<p>$$
F(t) = \sum_{x=0}^{N-1} f(x) \exp\left(-i\frac{2 \pi t x}{N}\right)
$$</p>
<p>と定義したとき、
逆変換は
$$
f(x) = \frac{1}{N} \sum<em>{t=0}^{N-1} F(t) \exp\left(i\frac{2\pi{tx}}{N}\right)
= \frac{1}{N} \overline{ \sum</em>{t=0}^{N-1} \overline{F(t)} \exp\left(-i\frac{2 \pi t x}{N} \right)}
$$</p>
<p>このため、$F(t)$ の離散フーリエ逆変換を求めるには、</p>
<ol>
<li>複素共役を取り、$\overline{F(t)}$ を求める</li>
<li>$\overline{F(t)}$ の正変換の離散フーリエ変換を高速フーリエ変換で行う</li>
<li>その結果の複素共役を取り、$N$ で割る</li>
</ol>
<p>とすることで求められる。</p>
<h3>FFT</h3>
<p>$\bf{W} = e^{-\frac{2\pi}{N}i}$として、</p>
<p>$$
X<em>k = \sum</em>{n=0}^{N-1} x_n \bf{W}^{nk}
$$</p>
<p>まず、偶数列とき数列に分割してみる。</p>
<p>$N = 2^3 = 8$ として進める。
$$
\begin{aligned}
X<em>k &#x26;= \sum</em>{r=0}^3 x<em>{2r}\bf{W}^{2rk} + \sum</em>{r=0}^3 x<em>{2r+1}\bf{W}^{(2r+1)k} \
&#x26;= \sum</em>{r=0}^3 x<em>{2r}\bf{W}^{2rk} + \bf{W}^k \sum</em>{r=0}^3 x_{2r+1}\bf{W}^{2rk}
\end{aligned}
$$</p>
<p>ここで、
$$
\bf{W}^k = - \bf{W}^{k-4}
$$</p>
<p>を利用して、</p>
<p>8点DFTを2つの4点DFTに分解することができる。</p>
<p>同様に、4点DFTを2つの2点DFTに分解することができる。</p>
<h2>多項式乗算への応用</h2>
<p>長さが$N,M$の多項式$f(x),g(x)$において、
$f(x)g(x)$を計算したい。</p>
<ul>
<li>愚直に計算すると$O(MN)$</li>
</ul>
<p>$f(x)$ を $N-1$次の多項式、$\zeta<em>N$ を1の$N$乗根とすると、
$$
\begin{aligned}
\hat{f}(t) &#x26;= \sum</em>{k=0}^{N-1}f(\zeta_N^k)t^i \
&#x26;= f(\zeta_N^0)t^0 + f(\zeta_N^1)t^1 + \cdots + f(\zeta_N^{N-2})t^{N-2} + f(\zeta_N^{N-1}t^{N-1}
\end{aligned}
$$
と表される。</p>
<ul>
<li>Inverse DFT</li>
</ul>
<p>$\zeta_N$ を $\zeta_N^{-1}$ として $N$ で割ると得られる。</p>
<p>$$
f(x) = \frac{1}{N}\sum_{i=0}^{N-1}\hat{f}(\zeta_N^{-i})x^i
$$</p>
<p>より、
$f(x)g(x)$の多項式乗算においては</p>
<p>DFTをにより $\hat{f}(t), \hat{g}(t)$ を求め、これらを掛け合わせることで
$\hat{f\cdot g}(t)$ を求める。</p>
<p>これに対して IDFT で
$f(x)g(x)$を復元することにより、求める値が得られる。</p>
<h3>参考</h3>
<ul>
<li><a href="https://ja.wikipedia.org/wiki/%E9%AB%98%E9%80%9F%E3%83%95%E3%83%BC%E3%83%AA%E3%82%A8%E5%A4%89%E6%8F%9B">高速フーリエ変換(Wikipedia)</a></li>
</ul>
</div></div></article></div></main></div><footer class="bg-accent-1 border-t border-accent-2"><div class="container mx-auto px-5"></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"信号処理入門４","date":"2021-08-14T15:35:07","slug":"信号処理入門4","content":"\u003ch2\u003e高速フーリエ変換(Fast Fourier Transform; FFT)\u003c/h2\u003e\n\u003cp\u003e離散フーリエ変換を高速に計算するアルゴリズム。\u003c/p\u003e\n\u003cp\u003eこれを応用し、多項式の乗算が高速になる。\u003c/p\u003e\n\u003cp\u003e応用例：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eOFDM\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003e離散フーリエ変換の概要\u003c/h3\u003e\n\u003cp\u003e離散フーリエ変換は複素関数\n$f(x)$\nを複素関数\n$F(t)$\nに写す写像であって、次の式で定義される。\n$$\nF(t)= \\sum_{x=0}^{N-1} f(x) \\exp\\left(-i\\frac{2 \\pi t x}{N} \\right)\n$$\u003c/p\u003e\n\u003cp\u003e逆変換にあたる離散フーリエ逆変換（Inverse Discrete Fourier Transform; IDFT）は次の式で定義される。\n$$\nf(x) = \\frac{1}{N} \\sum_{t=0}^{N-1} F(t) \\exp\\left(i\\frac{2\\pi x t}{N} \\right)\n$$\u003c/p\u003e\n\u003cp\u003e複素関数$f(x)$の離散フーリエ変換である複素関数$F(t)$は以下の式で定義される。\n$$\nF(t)= \\sum_{x=0}^{N-1} f(x) \\exp\\left(-i\\frac{2 \\pi t x}{N} \\right)\n$$\u003c/p\u003e\n\u003cp\u003eこれを愚直に計算すると $O(N^2)$ の計算量になる。\u003c/p\u003e\n\u003cp\u003e高速フーリエ変換は、この結果を次数$N$が$2$の累乗のときに $O(N \\log N)$ の計算量で得るアルゴリズムである。\u003c/p\u003e\n\u003cp\u003eより一般的には、次数が $N=\\prod n_i$ と素因数分解できるとき、$O(N\\sum n_i)$ の計算量となる。\u003c/p\u003e\n\u003cp\u003e次数が $2$ の累乗の場合に最も高速に計算できる。\u003c/p\u003e\n\u003cp\u003e高速フーリエ変換を利用し、畳み込み積分などの計算を高速に求めることができる。\nこれも計算量を $O(N^2)$ から $O(N \\log N)$ まで落とすことが可能となる。\u003c/p\u003e\n\u003cp\u003e逆変換については正変換とほぼ同じであるが、指数の符号が逆となり、係数$1/N$がかかる。\u003c/p\u003e\n\u003cp\u003eすなわち、\u003c/p\u003e\n\u003cp\u003e$$\nF(t) = \\sum_{x=0}^{N-1} f(x) \\exp\\left(-i\\frac{2 \\pi t x}{N}\\right)\n$$\u003c/p\u003e\n\u003cp\u003eと定義したとき、\n逆変換は\n$$\nf(x) = \\frac{1}{N} \\sum\u003cem\u003e{t=0}^{N-1} F(t) \\exp\\left(i\\frac{2\\pi{tx}}{N}\\right)\n= \\frac{1}{N} \\overline{ \\sum\u003c/em\u003e{t=0}^{N-1} \\overline{F(t)} \\exp\\left(-i\\frac{2 \\pi t x}{N} \\right)}\n$$\u003c/p\u003e\n\u003cp\u003eこのため、$F(t)$ の離散フーリエ逆変換を求めるには、\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e複素共役を取り、$\\overline{F(t)}$ を求める\u003c/li\u003e\n\u003cli\u003e$\\overline{F(t)}$ の正変換の離散フーリエ変換を高速フーリエ変換で行う\u003c/li\u003e\n\u003cli\u003eその結果の複素共役を取り、$N$ で割る\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eとすることで求められる。\u003c/p\u003e\n\u003ch3\u003eFFT\u003c/h3\u003e\n\u003cp\u003e$\\bf{W} = e^{-\\frac{2\\pi}{N}i}$として、\u003c/p\u003e\n\u003cp\u003e$$\nX\u003cem\u003ek = \\sum\u003c/em\u003e{n=0}^{N-1} x_n \\bf{W}^{nk}\n$$\u003c/p\u003e\n\u003cp\u003eまず、偶数列とき数列に分割してみる。\u003c/p\u003e\n\u003cp\u003e$N = 2^3 = 8$ として進める。\n$$\n\\begin{aligned}\nX\u003cem\u003ek \u0026#x26;= \\sum\u003c/em\u003e{r=0}^3 x\u003cem\u003e{2r}\\bf{W}^{2rk} + \\sum\u003c/em\u003e{r=0}^3 x\u003cem\u003e{2r+1}\\bf{W}^{(2r+1)k} \\\n\u0026#x26;= \\sum\u003c/em\u003e{r=0}^3 x\u003cem\u003e{2r}\\bf{W}^{2rk} + \\bf{W}^k \\sum\u003c/em\u003e{r=0}^3 x_{2r+1}\\bf{W}^{2rk}\n\\end{aligned}\n$$\u003c/p\u003e\n\u003cp\u003eここで、\n$$\n\\bf{W}^k = - \\bf{W}^{k-4}\n$$\u003c/p\u003e\n\u003cp\u003eを利用して、\u003c/p\u003e\n\u003cp\u003e8点DFTを2つの4点DFTに分解することができる。\u003c/p\u003e\n\u003cp\u003e同様に、4点DFTを2つの2点DFTに分解することができる。\u003c/p\u003e\n\u003ch2\u003e多項式乗算への応用\u003c/h2\u003e\n\u003cp\u003e長さが$N,M$の多項式$f(x),g(x)$において、\n$f(x)g(x)$を計算したい。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e愚直に計算すると$O(MN)$\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e$f(x)$ を $N-1$次の多項式、$\\zeta\u003cem\u003eN$ を1の$N$乗根とすると、\n$$\n\\begin{aligned}\n\\hat{f}(t) \u0026#x26;= \\sum\u003c/em\u003e{k=0}^{N-1}f(\\zeta_N^k)t^i \\\n\u0026#x26;= f(\\zeta_N^0)t^0 + f(\\zeta_N^1)t^1 + \\cdots + f(\\zeta_N^{N-2})t^{N-2} + f(\\zeta_N^{N-1}t^{N-1}\n\\end{aligned}\n$$\nと表される。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eInverse DFT\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e$\\zeta_N$ を $\\zeta_N^{-1}$ として $N$ で割ると得られる。\u003c/p\u003e\n\u003cp\u003e$$\nf(x) = \\frac{1}{N}\\sum_{i=0}^{N-1}\\hat{f}(\\zeta_N^{-i})x^i\n$$\u003c/p\u003e\n\u003cp\u003eより、\n$f(x)g(x)$の多項式乗算においては\u003c/p\u003e\n\u003cp\u003eDFTをにより $\\hat{f}(t), \\hat{g}(t)$ を求め、これらを掛け合わせることで\n$\\hat{f\\cdot g}(t)$ を求める。\u003c/p\u003e\n\u003cp\u003eこれに対して IDFT で\n$f(x)g(x)$を復元することにより、求める値が得られる。\u003c/p\u003e\n\u003ch3\u003e参考\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://ja.wikipedia.org/wiki/%E9%AB%98%E9%80%9F%E3%83%95%E3%83%BC%E3%83%AA%E3%82%A8%E5%A4%89%E6%8F%9B\"\u003e高速フーリエ変換(Wikipedia)\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n","tags":["信号処理","基礎","フーリエ変換","離散フーリエ変換"]}},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"信号処理入門4"},"buildId":"j3CLuIGZanrgxVfWdCrAG","assetPrefix":"/math-note","runtimeConfig":{"basePath":"/math-note"},"isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>