<!DOCTYPE html><html lang="ja"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="icon" type="image/png" sizes="32x32" href="/math-note/favicon/favicon-32x32.png"/><link rel="shortcut icon" href="/math-note/favicon/favicon.ico"/><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-config" content="/favicon/browserconfig.xml"/><meta name="theme-color" content="#000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><meta name="description" content="mathematics"/><title>逆元を求める</title><meta name="next-head-count" content="10"/><link rel="preload" href="/math-note/_next/static/css/7f2c1bc6a387af36.css" as="style"/><link rel="stylesheet" href="/math-note/_next/static/css/7f2c1bc6a387af36.css" data-n-g=""/><link rel="preload" href="/math-note/_next/static/css/0679eaaad63193ca.css" as="style"/><link rel="stylesheet" href="/math-note/_next/static/css/0679eaaad63193ca.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/math-note/_next/static/chunks/polyfills-a40ef1678bae11e696dba45124eadd70.js"></script><script src="/math-note/_next/static/chunks/webpack-832375101e671a83.js" defer=""></script><script src="/math-note/_next/static/chunks/framework-91d7f78b5b4003c8.js" defer=""></script><script src="/math-note/_next/static/chunks/main-a5f2beb8b3d215d7.js" defer=""></script><script src="/math-note/_next/static/chunks/pages/_app-57f97a3cc8323c9b.js" defer=""></script><script src="/math-note/_next/static/chunks/613-a72f04a2ce04000a.js" defer=""></script><script src="/math-note/_next/static/chunks/pages/posts/%5Bslug%5D-dec6356905c85262.js" defer=""></script><script src="/math-note/_next/static/j3CLuIGZanrgxVfWdCrAG/_buildManifest.js" defer=""></script><script src="/math-note/_next/static/j3CLuIGZanrgxVfWdCrAG/_ssgManifest.js" defer=""></script><script src="/math-note/_next/static/j3CLuIGZanrgxVfWdCrAG/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous"/><div class="min-h-screen"><nav class="py-4"><a href="/math-note"><a class="m-8 md:m-8 hover:underline hover:text-blue-800 cursor-pointer">Math note</a></a><a href="/math-note/tags"><a class="m-8 md:m-8 hover:underline hover:text-blue-800 cursor-pointer">Tags</a></a><a href="/math-note/about"><a class="m-8 md:m-8 hover:underline hover:text-blue-800 cursor-pointer">About</a></a></nav><main><div class="container mx-auto px-5"><h2 class="text-2xl md:text-4xl font-bold tracking-tight md:tracking-tighter leading-tight mb-20 mt-8"><a class="hover:underline" href="/math-note">Math note</a></h2><article class="mb-32"><div class="max-w-2xl mx-auto"><div class="flex flex-wrap"><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/math-note/tags/%E5%9F%BA%E7%A4%8E">基礎</a><a class="mr-3 text-sm font-medium uppercase text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/math-note/tags/%E6%95%B4%E6%95%B0%E8%AB%96">整数論</a></div><div class="mb-6 text-lg"><time dateTime="2021-08-16T18:35:07">2021/08/16</time></div><hr/></div><div class="max-w-2xl mx-auto"><div class="markdown-styles_markdown__1x9gM"><h2>逆元を求める</h2>
<p>法$p$の元での逆元を求めたい。</p>
<p>すなわち、</p>
<p>$$
a^{-1} \cdot a \equiv  1 \pmod p
$$</p>
<p>を満たす $a^{-1}$ を求める。</p>
<p>このとき、$a$ と $p$ は互いに素とする。</p>
<h3>式変形</h3>
<p>$p$を$a$で割ると</p>
<p>$$
p = \lfloor \frac{p}{a} \rfloor \cdot a + (p \mod a)
$$</p>
<p>より、</p>
<p>$$
0 \equiv \lfloor \frac{p}{a} \rfloor \cdot a + (p \mod a) \pmod p
$$</p>
<p>$$
(p \mod a) \cdot a^{-1} \equiv - \lfloor \frac{p}{a} \rfloor \pmod p
$$</p>
<p>$$
a^{-1} \equiv -(p \mod a)^{-1} \cdot \lfloor \frac{p}{a} \rfloor \pmod p
$$</p>
<p>よって、$p \mod a$ の逆元が求められていたら $a^{-1}$も簡潔に求められる。</p>
<p>$p = 7$ として実験してみると、</p>
<p>$$
1^{-1} \equiv 1 \pmod 7
$$
$$
2^{-1} \equiv - (7 \mod 2)^{-1} \cdot \lfloor \frac{7}{2} \rfloor \equiv -1 \cdot 3 \equiv 4 \pmod 7
$$</p>
<p>$$
3^{-1} \equiv - (7 \mod 3)^{-1} \cdot \lfloor
\frac{7}{3} \rfloor \equiv -1 \cdot 2 \equiv 5
$$</p>
<p>$$
4^{-1} \equiv -(7 \mod 4)^{-1} \cdot \lfloor \frac{7}{4} \rfloor \equiv - 3^{-1} \cdot 1 \equiv -5 \equiv 2
$$</p>
<p>のように$1^{-1}$を起点として逆元を求めていくことができる。</p>
<h3>拡張ユークリッドの互除法</h3>
<p>逆元を求めるには、</p>
<p>$$
a^{-1} \cdot a \equiv 1 \pmod p
$$</p>
<p>$$
a^{-1} \cdot a - 1 \equiv 0 \pmod p
$$
より、</p>
<p>不定方程式
$$
a^{-1} \cdot a - 1 = n \cdot p
$$
となる。</p>
<p>少し変形して、</p>
<p>$$
a^{-1} \cdot a + n\cdot p = 1
$$</p>
<p>が得られ、拡張ユークリッドの互除法で求められそうな式ができる。</p>
<p>$$
ax + py = 1
$$
の解を求めたときの$x$ が $a^{-1}$ である。</p>
<p>$p$を$a$で割ると、</p>
<p>$$
p = qa + r
$$</p>
<p>になるとする。</p>
<p>これをもとの式に代入して、</p>
<p>$$
ax + (qa + r)y = 1 \Leftrightarrow ry + a(x+qy) = 1
$$</p>
<p>よって、
$a,p$ に関する問題が $\lfloor p/a \rfloor$, $p \mod a$ の問題に帰着できる。</p>
<p>この操作を続けていき、自明解に行き着く。
$$
rs + at = 1
$$</p>
<p>と解が得られたら、</p>
<p>$$
\left{
\begin{aligned}
s &#x26;= y\ t &#x26;= x+qy
\end{aligned}
\right.
\Leftrightarrow \left{
\begin{aligned}
x &#x26;= t-qs\ y &#x26;= s
\end{aligned}
\right.
$$</p>
<p>で$x,y$ を戻していくことができる。</p>
<p>よって$x$が求められる。</p>
<h2>フェルマーの小定理</h2>
<p>$p$ が素数で $a$ と $p$ が互いに素なとき、以下の式が成立する。</p>
<p>$$
a^{p-1} \equiv 1 \pmod p
$$</p>
<p>このとき、
$$
a^{p-2}\cdot a \equiv 1 \pmod p
$$</p>
<p>であるから、</p>
<p>$$
a^{-1} \equiv a^{p-2}  \pmod p
$$
が成立する。</p>
<p>※ この計算は繰り返し二乗法を用いることで$\lceil\log_2 p\rceil$回程度の乗算で計算できる。</p>
</div></div></article></div></main></div><footer class="bg-accent-1 border-t border-accent-2"><div class="container mx-auto px-5"></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"逆元を求める","date":"2021-08-16T18:35:07","slug":"逆元を求める","content":"\u003ch2\u003e逆元を求める\u003c/h2\u003e\n\u003cp\u003e法$p$の元での逆元を求めたい。\u003c/p\u003e\n\u003cp\u003eすなわち、\u003c/p\u003e\n\u003cp\u003e$$\na^{-1} \\cdot a \\equiv  1 \\pmod p\n$$\u003c/p\u003e\n\u003cp\u003eを満たす $a^{-1}$ を求める。\u003c/p\u003e\n\u003cp\u003eこのとき、$a$ と $p$ は互いに素とする。\u003c/p\u003e\n\u003ch3\u003e式変形\u003c/h3\u003e\n\u003cp\u003e$p$を$a$で割ると\u003c/p\u003e\n\u003cp\u003e$$\np = \\lfloor \\frac{p}{a} \\rfloor \\cdot a + (p \\mod a)\n$$\u003c/p\u003e\n\u003cp\u003eより、\u003c/p\u003e\n\u003cp\u003e$$\n0 \\equiv \\lfloor \\frac{p}{a} \\rfloor \\cdot a + (p \\mod a) \\pmod p\n$$\u003c/p\u003e\n\u003cp\u003e$$\n(p \\mod a) \\cdot a^{-1} \\equiv - \\lfloor \\frac{p}{a} \\rfloor \\pmod p\n$$\u003c/p\u003e\n\u003cp\u003e$$\na^{-1} \\equiv -(p \\mod a)^{-1} \\cdot \\lfloor \\frac{p}{a} \\rfloor \\pmod p\n$$\u003c/p\u003e\n\u003cp\u003eよって、$p \\mod a$ の逆元が求められていたら $a^{-1}$も簡潔に求められる。\u003c/p\u003e\n\u003cp\u003e$p = 7$ として実験してみると、\u003c/p\u003e\n\u003cp\u003e$$\n1^{-1} \\equiv 1 \\pmod 7\n$$\n$$\n2^{-1} \\equiv - (7 \\mod 2)^{-1} \\cdot \\lfloor \\frac{7}{2} \\rfloor \\equiv -1 \\cdot 3 \\equiv 4 \\pmod 7\n$$\u003c/p\u003e\n\u003cp\u003e$$\n3^{-1} \\equiv - (7 \\mod 3)^{-1} \\cdot \\lfloor\n\\frac{7}{3} \\rfloor \\equiv -1 \\cdot 2 \\equiv 5\n$$\u003c/p\u003e\n\u003cp\u003e$$\n4^{-1} \\equiv -(7 \\mod 4)^{-1} \\cdot \\lfloor \\frac{7}{4} \\rfloor \\equiv - 3^{-1} \\cdot 1 \\equiv -5 \\equiv 2\n$$\u003c/p\u003e\n\u003cp\u003eのように$1^{-1}$を起点として逆元を求めていくことができる。\u003c/p\u003e\n\u003ch3\u003e拡張ユークリッドの互除法\u003c/h3\u003e\n\u003cp\u003e逆元を求めるには、\u003c/p\u003e\n\u003cp\u003e$$\na^{-1} \\cdot a \\equiv 1 \\pmod p\n$$\u003c/p\u003e\n\u003cp\u003e$$\na^{-1} \\cdot a - 1 \\equiv 0 \\pmod p\n$$\nより、\u003c/p\u003e\n\u003cp\u003e不定方程式\n$$\na^{-1} \\cdot a - 1 = n \\cdot p\n$$\nとなる。\u003c/p\u003e\n\u003cp\u003e少し変形して、\u003c/p\u003e\n\u003cp\u003e$$\na^{-1} \\cdot a + n\\cdot p = 1\n$$\u003c/p\u003e\n\u003cp\u003eが得られ、拡張ユークリッドの互除法で求められそうな式ができる。\u003c/p\u003e\n\u003cp\u003e$$\nax + py = 1\n$$\nの解を求めたときの$x$ が $a^{-1}$ である。\u003c/p\u003e\n\u003cp\u003e$p$を$a$で割ると、\u003c/p\u003e\n\u003cp\u003e$$\np = qa + r\n$$\u003c/p\u003e\n\u003cp\u003eになるとする。\u003c/p\u003e\n\u003cp\u003eこれをもとの式に代入して、\u003c/p\u003e\n\u003cp\u003e$$\nax + (qa + r)y = 1 \\Leftrightarrow ry + a(x+qy) = 1\n$$\u003c/p\u003e\n\u003cp\u003eよって、\n$a,p$ に関する問題が $\\lfloor p/a \\rfloor$, $p \\mod a$ の問題に帰着できる。\u003c/p\u003e\n\u003cp\u003eこの操作を続けていき、自明解に行き着く。\n$$\nrs + at = 1\n$$\u003c/p\u003e\n\u003cp\u003eと解が得られたら、\u003c/p\u003e\n\u003cp\u003e$$\n\\left{\n\\begin{aligned}\ns \u0026#x26;= y\\ t \u0026#x26;= x+qy\n\\end{aligned}\n\\right.\n\\Leftrightarrow \\left{\n\\begin{aligned}\nx \u0026#x26;= t-qs\\ y \u0026#x26;= s\n\\end{aligned}\n\\right.\n$$\u003c/p\u003e\n\u003cp\u003eで$x,y$ を戻していくことができる。\u003c/p\u003e\n\u003cp\u003eよって$x$が求められる。\u003c/p\u003e\n\u003ch2\u003eフェルマーの小定理\u003c/h2\u003e\n\u003cp\u003e$p$ が素数で $a$ と $p$ が互いに素なとき、以下の式が成立する。\u003c/p\u003e\n\u003cp\u003e$$\na^{p-1} \\equiv 1 \\pmod p\n$$\u003c/p\u003e\n\u003cp\u003eこのとき、\n$$\na^{p-2}\\cdot a \\equiv 1 \\pmod p\n$$\u003c/p\u003e\n\u003cp\u003eであるから、\u003c/p\u003e\n\u003cp\u003e$$\na^{-1} \\equiv a^{p-2}  \\pmod p\n$$\nが成立する。\u003c/p\u003e\n\u003cp\u003e※ この計算は繰り返し二乗法を用いることで$\\lceil\\log_2 p\\rceil$回程度の乗算で計算できる。\u003c/p\u003e\n","tags":["基礎","整数論"]}},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"逆元を求める"},"buildId":"j3CLuIGZanrgxVfWdCrAG","assetPrefix":"/math-note","runtimeConfig":{"basePath":"/math-note"},"isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>